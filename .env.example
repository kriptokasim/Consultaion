# -----------------
# Core application
# -----------------
ENV=development
# Set to staging/production to require Redis for SSE/rate limiting
APP_VERSION=0.2.0
WEB_APP_ORIGIN=http://localhost:3000
CORS_ORIGINS=http://localhost:3000
ENABLE_SEC_HEADERS=1
ENABLE_METRICS=1
WEB_CONCURRENCY=1
GUNICORN_WORKERS=

# -----------------
# Database & queues
# -----------------
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/consultaion
DB_ECHO=0
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_RECYCLE=3600
EXPORT_DIR=exports
SSE_BACKEND=memory
SSE_REDIS_URL=
SSE_CHANNEL_TTL_SECONDS=900

# -----------------
# Debate dispatch / workers
# -----------------
DEBATE_DISPATCH_MODE=inline
# CELERY_BROKER_URL=redis://redis:6379/0
# CELERY_RESULT_BACKEND=redis://redis:6379/0

# --- Provider health & dispatch ---
PROVIDER_HEALTH_WINDOW_SECONDS=300
PROVIDER_HEALTH_ERROR_THRESHOLD=0.5
PROVIDER_HEALTH_MIN_CALLS=10
PROVIDER_HEALTH_COOLDOWN_SECONDS=60

DEBATE_FAST_QUEUE_NAME=debates_fast
DEBATE_DEEP_QUEUE_NAME=debates_deep
DEBATE_DEFAULT_QUEUE=debates_fast

# -----------------
# Auth & security
# -----------------
# CHANGE THIS in every environment
JWT_SECRET=change_me_in_prod
JWT_TTL_SECONDS=86400
PASSWORD_ITERATIONS=150000
COOKIE_NAME=consultaion_session
COOKIE_PATH=/
COOKIE_SAMESITE=lax
COOKIE_SECURE=false
ENABLE_CSRF=1

# Cross-Origin Deployment (Vercel + Render) - Patchset 51.0
# -----------------------------------------------------------
# For production deployments where frontend and backend are on different domains:
# - Frontend on Vercel (e.g., consultaion.vercel.app)
# - Backend on Render (e.g., consultaion.onrender.com)
#
# The system AUTO-DETECTS the environment:
# - Local dev (ENV=development): Uses COOKIE_SECURE=false, COOKIE_SAMESITE=lax
# - Render production: Auto-detects via RENDER env var, sets COOKIE_SECURE=true, COOKIE_SAMESITE=none
#
# Required Render environment variables:
#   ENV=production
#   WEB_APP_ORIGIN=https://consultaion.vercel.app
#   CORS_ORIGINS=https://consultaion.vercel.app
#   JWT_SECRET=<your-secure-32+-char-string>
#
# Required Vercel environment variables:
#   NEXT_PUBLIC_API_URL=https://consultaion.onrender.com
#
# The RENDER env var is set automatically by Render platform - DO NOT set it manually.
# See docs/deployment/ for complete deployment guides.

# Email/password auth limits
RL_MAX_CALLS=5
RL_WINDOW=60
AUTH_RL_MAX_CALLS=10
AUTH_RL_WINDOW=300

# Google OAuth - register the redirect in Google Cloud Console
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URL=http://localhost:8000/auth/google/callback
GOOGLE_API_KEY=

# -----------------
# LLM providers & orchestrator
# -----------------
USE_MOCK=1
REQUIRE_REAL_LLM=0
FAST_DEBATE=0
DISABLE_AUTORUN=0
LITELLM_MODEL=gpt-4o-mini
LITELLM_API_BASE=https://api.openai.com/v1
OPENAI_API_KEY=sk-...
OPENROUTER_API_KEY=
GROQ_API_KEY=
MISTRAL_API_KEY=
ANTHROPIC_API_KEY=
GEMINI_API_KEY=
AZURE_API_KEY=
LITELLM_API_KEY=
# POE_API_KEY=
LLM_RETRY_ENABLED=1
LLM_RETRY_MAX_ATTEMPTS=3
LLM_RETRY_INITIAL_DELAY_SECONDS=1.0
LLM_RETRY_MAX_DELAY_SECONDS=8.0

# --- Safety & secrets ---
ENABLE_PII_SCRUB=true
# JWT_SECRET must be 32+ characters and non-default outside local dev

DEFAULT_MAX_RUNS_PER_HOUR=30
DEFAULT_MAX_TOKENS_PER_DAY=150000
DISABLE_RATINGS=0

# -----------------
# Observability
# -----------------
SENTRY_DSN=
SENTRY_ENV=local
SENTRY_SAMPLE_RATE=0.1
NEXT_PUBLIC_SENTRY_DSN=

# -----------------
# Frontend runtime config
# -----------------
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_VOTE_THRESHOLD=7
NEXT_PUBLIC_AUTORUN_HINT=on
NEXT_PUBLIC_WEB_URL=
NEXT_PUBLIC_APP_URL=
NEXT_PUBLIC_WEB_ORIGIN=
NEXT_PUBLIC_APP_ORIGIN=
NEXT_PUBLIC_SITE_URL=
PLAYWRIGHT_BASE_URL=http://127.0.0.1:3000

# -----------------
# Rate limiter backend
# -----------------
RATE_LIMIT_BACKEND=memory
# Required in staging/production for SSE + rate limiting
REDIS_URL=redis://localhost:6379/0

# -----------------
# Debate failure tolerance (advanced)
# -----------------
DEBATE_MAX_SEAT_FAIL_RATIO=0.4
DEBATE_MIN_REQUIRED_SEATS=1
DEBATE_FAIL_FAST=1

# -----------------
# Billing & automations
# -----------------
BILLING_PROVIDER=stripe
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_PRO_ID=
STRIPE_WEBHOOK_INSECURE_DEV=0
BILLING_CHECKOUT_SUCCESS_URL=http://localhost:3000/settings/billing?status=success
BILLING_CHECKOUT_CANCEL_URL=http://localhost:3000/settings/billing?status=cancel
N8N_WEBHOOK_URL=
